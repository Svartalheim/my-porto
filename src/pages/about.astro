---
import Layout from '../layouts/layout.astro';
import AboutTitle from '@assets/svg/about-title.svg';
import FacetTitle from '@assets/svg/facet-title.svg';
import AboutPhoto from '@assets/images/case-study-all.webp';
import Arrow from '@assets/svg/arrow.svg';
import Flare from '@assets/svg/flare.svg';
import ImageAboutNavbar from '@assets/images/about.png';
import { Image } from 'astro:assets';
import { Separator } from '@components/ui/separator';

type SpecialitiesItem = { header: string; desc: string; meta?: string };

const SPECIALITIES: SpecialitiesItem[] = [
  {
    header: 'Analytics dashboards & data viz',
    desc: 'Dashboard-builder UIs wired to MySQL, MariaDB, SingleStore, and PostgreSQL. Composable portlets, faceted filters, and configurable charts with clear empty/loading states.',
    meta: 'Portlet — Pages — Dashboards',
  },
  {
    header: 'Next.js architecture & design systems',
    desc: 'Type-safe React/Next.js with shadcn/ui, TanStack (Table/Query), react-hook-form + Zod. Atomic components, design tokens, and pragmatic state management that scales.',
    meta: 'SSR/ISR where useful · per-route caching',
  },
  {
    header: 'Workflow-driven apps (LMS & enterprise)',
    desc: 'Translate multi-role processes into robust web flows—courses, schedules, experts, classrooms, learners, and logistics—complete with RBAC, validation, and admin tooling.',
    meta: 'Roles & permissions · audit-friendly forms',
  },
];
---

<Layout title='about' name='about'>
  <div class='lg:p-[8.333vw] p-[2.333vw]'>
    <div
      class='flex justify-center lg:block px-4 mb-20 [&>*]:w-full [&>*]:h-auto'
      id='about-title'
    >
      <AboutTitle />
    </div>
    <div id='about-header' class='flex justify-center flex-col'>
      <div class='bg-black rounded-[5px] w-[80%] mx-auto overflow-hidden'>
        <Image src={ImageAboutNavbar} alt='about' class='scale-[101%]' />
      </div>
      <Arrow class={'my-12 mx-auto'} />
      <header id='about-hero' class='space-y-5 text-center w-[80%] mx-auto'>
        <p class='p-large'>An Indie Web Developer</p>
        <p class='p-medium font-light'>
          Web Developer based in Indonesia. Presently engaged as a front-end web
          engineer operating on a fulltime basis. Open for a remote position
          anywhere.
        </p>
        <p class='p-medium font-light'>
          I’ve always believed the best websites don’t just look good — they
          make an impact.
        </p>
      </header>
    </div>
  </div>
  <div
    class='text-background bg-primary background-expander relative px-[2vw] lg:p-[8.333vw]'
  >
    <section
      id='whats-different'
      class='mt-[100px] pb-[50px] py-[50px] px-[2vw] lg:p-[8.333vw] pt-[2.333vw]'
    >
      <div
        class='flex justify-center lg:block px-4 mb-[10vw] [&>*]:w-full [&>*]:h-auto [&_*]:fill-white'
        id='about-title'
      >
        <FacetTitle />
      </div>
      <div class='pb-[4.333vw] flex gap-4 p-medium font-light mx-auto'>
        <Flare height={40} width={40} class={'min-w-[40px] h-auto'} />
        <span>
          I build fast, accessible web apps—analytics dashboards and workflow
          tools—using Next.js/React and type-safe systems that turn complex data
          into clear decisions.
        </span>
      </div>
      <Separator className={'bg-background'} />
      <div class='p-medium gap-1 font-light flex flex-col'>
        {
          SPECIALITIES.map((item, index) => (
            <>
              <div class='pb-[1.333vw] py-[3.33vw]' id={`speciality-${index}`}>
                <h3 class='p-large font-medium speciality-title'>
                  {item.header}
                </h3>
                <p
                  class='p-small min-h-0 h-0 opacity-0 max-h-fit  font-light speciality-desc '
                  data-index={index}
                >
                  {item.desc}
                </p>
                {item.meta && <p class='mt-2 p-tiny'>{item.meta}</p>}
              </div>
              <div class=' bg-primary'>
                <Separator className={'speciality-separator bg-background'} />
              </div>
            </>
          ))
        }
      </div>
    </section>
    <section id='why-us'>
      <div
        class='lg:pr-[var(--size-20)] lg:w-[calc(100%-31.458333333333332vw)] lg:flex flex-col justify-between pb-[200px]'
      >
        <div class='lg:pt-[0.20833333333333334vw]'>
          <div class='section-indent'>
            <div>
              <h2>
                Hello, I'm Svartalheim. A web developer mostly develop on
                front-end side.
              </h2>
            </div>
          </div>
        </div>
        <div class='lg:hidden mt-[13px] mb-[38px]'>
          <div class='overflow-hidden rounded-[5px]'>
            <Image
              src={AboutPhoto}
              class='w-full h-auto'
              alt={'Photo about us'}
            />
          </div>
        </div>
        <div
          class='lg:max-w-[31.458333333333332vw] lg:ml-auto lg:mt-[5.555555555555555vw]'
        >
          <div class='description'>
            With us, you tap into a vibrant mix of functional<br />
            creativity, innovation, and business-centric goals.<br />
            We pack a punch with tailored website solutions<br />
            that resonate with top brands' objectives.<br />
            With Our close-knit team, you receive personalized<br />
            attention and effortless integration with your<br />
            team’s goals.
          </div>
        </div>
      </div>
    </section>
  </div>
</Layout>
<script>
  import { gsap } from 'gsap';
  import { ScrollTrigger } from 'gsap/ScrollTrigger';
  gsap.registerPlugin(ScrollTrigger);

  // keep track of just our triggers
  let specialityTriggers = new Set();

  function killSpecialities() {
    specialityTriggers.forEach((t: any) => t.kill());
    specialityTriggers.clear();
  }

  function initSpecialitiesAnimation() {
    killSpecialities(); // prevent duplicates
    const descriptions = document.querySelectorAll('.speciality-desc');
    const titles = document.querySelectorAll('.speciality-title');
    if (!descriptions.length || !titles.length) {
      return;
    }
    descriptions.forEach((item) => {
      const tl = gsap.timeline({
        scrollTrigger: {
          trigger: item,
          start: 'top 65%',
          end: 'bottom 30%',
          scrub: true,
          // markers: true,
        },
      });

      // First animate height
      tl.fromTo(
        item,
        { height: 0 },
        {
          height: 'auto',
          duration: 1,
          immediateRender: false,
        }
      )
        // Then animate opacity (starts before height finishes)
        .fromTo(
          item,
          { opacity: 0 },
          {
            opacity: 1,
            duration: 0.4,
            immediateRender: false,
          },
          '-=0.5' // Start 0.3 seconds before the height animation ends
        );
    });
    titles.forEach((item) => {
      const tl = gsap.timeline({
        scrollTrigger: {
          trigger: item,
          start: 'top 65%',
          end: 'bottom 30%',
          // scrub: true,
          // markers: true,
        },
      });

      // First animate height
      tl.fromTo(
        item,
        { marginBottom: 0 },
        {
          marginBottom: '1rem',
        },
        '-=0.3' // Start 0.3 seconds before the height animation ends
      );
    });
  }

  // Astro View Transitions lifecycle
  document.addEventListener('astro:before-swap', killSpecialities);

  document.addEventListener('astro:page-load', () => {
    setTimeout(() => {
      initSpecialitiesAnimation();
    }, 1000);
  });
</script>
