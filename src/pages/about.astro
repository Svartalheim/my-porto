---
import Layout from '../layouts/layout.astro';
import AboutTitle from '@assets/svg/about-title.svg';
import FacetTitle from '@assets/svg/facet-title.svg';

import Arrow from '@assets/svg/arrow.svg';
import Flare from '@assets/svg/flare.svg';
import ImageAboutNavbar from '@assets/images/about.png';
import { Image } from 'astro:assets';
import { Separator } from '@components/ui/separator';

type SpecialitiesItem = { header: string; desc: string };
const SPECIALITIES: SpecialitiesItem[] = [
  {
    header: 'Core Web Vitals & SEO',
    desc: 'Fast, responsive pages with image optimization, SSR/ISR where it helps, and clean semantics. WCAG 2.1 paths checked so performance and accessibility win together.',
  },
  {
    header: 'Type-safe, reusable UI',
    desc: 'React/Next.js + TypeScript component systems, design tokens, and prop-driven patterns that keep code predictable, testable, and easy to extend.',
  },
  {
    header: 'Modernize without drama',
    desc: 'Refactor legacy code into maintainable SPAs/SSR apps. Sensible client-side caching/state management to cut API load and speed up real user flows.',
  },
];
---

<Layout title='about' name='about'>
  <div class='lg:p-[8.333vw] p-[2.333vw]'>
    <div
      class='flex justify-center lg:block px-4 mb-20 [&>*]:w-full [&>*]:h-auto'
      id='about-title'
    >
      <AboutTitle />
    </div>
    <div id='about-header' class='flex justify-center flex-col'>
      <div class='bg-black rounded-[5px] w-[80%] mx-auto overflow-hidden'>
        <Image src={ImageAboutNavbar} alt='about' class='scale-[101%]' />
      </div>
      <Arrow class={'my-12 mx-auto'} />
      <header id='about-hero' class='space-y-5 text-center w-[80%] mx-auto'>
        <p class='p-large'>An Indie Web Developer</p>
        <p class='p-medium font-light'>
          Web Developer based in Indonesia. Presently engaged as a front-end web
          engineer operating on a fulltime basis. Open for a remote position
          anywhere.
        </p>
        <p class='p-medium font-light'>
          I’ve always believed the best websites don’t just look good — they
          make an impact.
        </p>
      </header>
    </div>
  </div>
  <div class='bg-primary text-background background-expander relative'>
    <section
      id='whats-different'
      class='mt-[100px] pb-[100px] py-[50px] px-[2vw] lg:p-[8.333vw] pt-[2.333vw]'
    >
      <div
        class='flex justify-center lg:block px-4 mb-[10vw] [&>*]:w-full [&>*]:h-auto [&_*]:fill-white'
        id='about-title'
      >
        <FacetTitle />
      </div>
      <div class='pb-[4.333vw] flex gap-4 p-medium font-light mx-auto'>
        <Flare height={40} width={40} class={'min-w-[40px] h-auto'} />
        <span>
          Whether it’s a small project or a large-scale build for established
          brands, I create digital experiences that stand out and give
          businesses a competitive edge.
        </span>
      </div>
      <Separator className={'bg-background'} />
      <div class='p-medium gap-1 font-light flex flex-col'>
        {
          SPECIALITIES.map((item, index) => (
            <>
              <div
                class='pb-[1.333vw] py-[3.33vw] space-y-10'
                id={`speciality-${index}`}
              >
                <h3 class='p-large font-medium'>{item.header}</h3>
                <p
                  class='p-small min-h-0 h-0 opacity-0  font-light speciality-desc '
                  data-index={index}
                >
                  {item.desc}
                </p>
              </div>
              <div class=' bg-primary'>
                <Separator className={'speciality-separator bg-background'} />
              </div>
            </>
          ))
        }
      </div>
    </section>
    <!-- <section id='why-us'>
      <div
        class='lg:pr-[var(--size-20)] lg:w-[calc(100%-31.458333333333332vw)] lg:flex flex-col justify-between'
      >
        <div class='lg:pt-[0.20833333333333334vw]'>
          <div class='section-indent'>
            <div
              class='inline-flex absolute left-0 section_name invisible opacity-0 width-view-indent'
            >
              Why atoll
            </div>
            <div
              class='section_name -mb-4 lg:mb-[-1.5277777777777777vw] pointer-events-none'
            >
              Why atoll
            </div>
            <div>
              <h2
                class='p-large'
                data-anim-splitting-scroll=''
                data-splitting-lines-overflow=''
                data-splitting=''
                style='opacity: 1; visibility: inherit;'
              >
                <div class='wrapper_line'>
                  <div
                    class='line'
                    style='display: block; text-align: start; position: relative; translate: none; rotate: none; scale: none; transform: translate(0px, 0px);'
                  >
                    <span
                      class='mr-[8.472222222222223vw] indent-margin-right'
                      style='margin-right: 89.3907px;'></span> Atoll Digital is born
                    from the
                  </div>
                </div>
                <div class='wrapper_line'>
                  <div
                    class='line'
                    style='display: block; text-align: start; position: relative; translate: none; rotate: none; scale: none; transform: translate(0px, 0px);'
                  >
                    dynamic fusion of design, technology,
                  </div>
                </div><div class='wrapper_line'>
                  <div
                    class='line'
                    style='display: block; text-align: start; position: relative; translate: none; rotate: none; scale: none; transform: translate(0px, 0px);'
                  >
                    and business development, crafting
                  </div>
                </div><div class='wrapper_line'>
                  <div
                    class='line'
                    style='display: block; text-align: start; position: relative; translate: none; rotate: none; scale: none; transform: translate(0px, 0px);'
                  >
                    captivating, functional solutions for
                  </div>
                </div><div class='wrapper_line'>
                  <div
                    class='line'
                    style='display: block; text-align: start; position: relative; translate: none; rotate: none; scale: none; transform: translate(0px, 0px);'
                  >
                    businesses.
                  </div>
                </div>
              </h2>
            </div>
          </div>
        </div>
        <div class='lg:hidden mt-[13px] mb-[38px]'>
          <div class='overflow-hidden rounded-[var(--rounded-base)]'>
            <img
              src='https://atolldigital.com/wp-content/uploads/2025/02/Atoll_Fusion_Des_Dev_Mobile.webp'
              class='w-full h-auto'
            />
          </div>
        </div>
        <div
          class='lg:max-w-[31.458333333333332vw] lg:ml-auto lg:mt-[5.555555555555555vw]'
        >
          <div class='description'>
            With us, you tap into a vibrant mix of functional<br />
            creativity, innovation, and business-centric goals.<br />
            We pack a punch with tailored website solutions<br />
            that resonate with top brands' objectives.<br />
            With Our close-knit team, you receive personalized<br />
            attention and effortless integration with your<br />
            team’s goals.
          </div>
        </div>
      </div>
    </section> -->
  </div>
</Layout>
<script>
  import { gsap } from 'gsap';
  import { ScrollTrigger } from 'gsap/ScrollTrigger';
  gsap.registerPlugin(ScrollTrigger);

  // keep track of just our triggers
  let specialityTriggers = new Set();

  function killSpecialities() {
    specialityTriggers.forEach((t: any) => t.kill());
    specialityTriggers.clear();
  }

  function initSpecialitiesAnimation() {
    killSpecialities(); // prevent duplicates
    const descriptions = document.querySelectorAll('.speciality-desc');
    if (!descriptions.length) {
      return;
    }
    descriptions.forEach((item) => {
      const tl = gsap.timeline({
        scrollTrigger: {
          trigger: item,
          start: 'top 65%',
          end: 'bottom 30%',
          scrub: true,
          // markers: true,
        },
      });

      // First animate height
      tl.fromTo(
        item,
        { height: 0 },
        {
          height: 'auto',
          duration: 1,
          immediateRender: false,
        }
      )
        // Then animate opacity (starts before height finishes)
        .fromTo(
          item,
          { opacity: 0 },
          {
            opacity: 1,
            duration: 0.4,
            immediateRender: false,
          },
          '-=0.5' // Start 0.3 seconds before the height animation ends
        );
    });
  }

  // Astro View Transitions lifecycle
  document.addEventListener('astro:before-swap', killSpecialities);

  document.addEventListener('astro:page-load', () => {
    setTimeout(() => {
      initSpecialitiesAnimation();
    }, 1000);
  });
</script>
